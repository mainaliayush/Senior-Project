<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ayush Mainali">

<title>UK Road Accidents</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="blog_files/libs/clipboard/clipboard.min.js"></script>
<script src="blog_files/libs/quarto-html/quarto.js"></script>
<script src="blog_files/libs/quarto-html/popper.min.js"></script>
<script src="blog_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="blog_files/libs/quarto-html/anchor.min.js"></script>
<link href="blog_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="blog_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="blog_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="blog_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="blog_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#dataset-description" id="toc-dataset-description" class="nav-link active" data-scroll-target="#dataset-description">Dataset Description</a></li>
  <li><a href="#analysis-and-visualizations" id="toc-analysis-and-visualizations" class="nav-link" data-scroll-target="#analysis-and-visualizations">Analysis and Visualizations</a></li>
  <li><a href="#machine-learning-models" id="toc-machine-learning-models" class="nav-link" data-scroll-target="#machine-learning-models">Machine Learning Models</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">UK Road Accidents</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Road Accident Analysis from 2005-2016</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ayush Mainali </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p><img src="./accident.jpeg" class="img-fluid"></p>
<p>Road accidents are a major cause of concern worldwide, and the situation is no different in Great Britain. With the increasing number of vehicles on the roads each year, it’s essential to analyze the available data to identify patterns and trends and take proactive measures to reduce road accidents. This blog post will provide a detailed report of personal injury road accident datasets available on Kaggle to gain a better understanding of road safety in Great Britain.</p>
<p>The datasets provide information on the circumstances of accidents, the types of vehicles involved, and the resulting casualties, making them a valuable resource for researchers and policymakers alike. However, it’s important to note that these statistics only cover personal injury accidents that are reported to the police and recorded using the STATS19 form(a form that offers features to retrieve and arrange data on road accidents, allowing users to access the UK’s authorized database of road traffic casualties.), so we must keep this limitation in mind when interpreting the results.</p>
<section id="dataset-description" class="level2">
<h2 class="anchored" data-anchor-id="dataset-description">Dataset Description</h2>
<p>The dataset in use is “The Great Britain Road Accident 2005-2016” dataset from Kaggle. Along with the accident report dataset, the dataset includes two other sub-datasets: Vehicle Description and Casualty Reference. The data as a whole was retrieved from the UK Department of Transportation government <a href="http://data.dft.gov.uk/road-accidents-safety-data/Road-Accident-Safety-Data-Guide.xls">website</a>.</p>
<p>The dataset has 1.7 million rows of data with 32 variable columns. For the 7% of null data in the dataset the rows are simply dropped in accordance to when they are beign analyzed. A couple of variables have integers instead of categorical descriptions, hence, the encoded values for variables such as light condition, road type, weather condition etc are mapped to their actual values for effective visualization.</p>
<p>The key variables in use for analysis are as follows:</p>
<ol type="i">
<li>Latitude and longitude: The geographic location of the data where the accident occured.</li>
<li>Accident Severity: The damage severity of accident (categorized by 1, 2 and 3(3 being the most severe))</li>
<li>Accident Day: The day of the week.</li>
<li>Accident Time: The time of the day.</li>
<li>Speed zone: The speed limit roads for accident.</li>
<li>Vehicle: Type of vehicle resulting in most number of accidents- cars/SUVs/Trucks, Bus etc</li>
<li>Road Type: Type of road that saw most number of the accidents</li>
<li>Light Condition: The light outside when the accident occured. Morning sun, midday light, dawn, dusk etc</li>
<li>The gender of accident: male, female, or others</li>
<li>Age: The driver’s age</li>
<li>Officers at scene: Number of police offices and local administratives that arrived in scene after the accident occured.</li>
<li>Road Surface condition: Conditions such as wet, damp, dry etc</li>
</ol>
<p>After reading the data through the file, adjusting the date and time format, reverse encoding the numerical to categorical values for the table, filtering and dropping the null values in accordance to what information is needed where, the final table summarizes to this:</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Installing and importing packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>pd.options.mode.chained_assignment <span class="op">=</span> <span class="va">None</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">FutureWarning</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>accidents <span class="op">=</span> pd.read_csv(<span class="st">"../data/accidents.csv"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>date_format <span class="op">=</span> <span class="st">"</span><span class="sc">%d</span><span class="st">/%m/%Y"</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Date"</span>] <span class="op">=</span> pd.to_datetime(accidents[<span class="st">"Date"</span>], <span class="bu">format</span><span class="op">=</span>date_format)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>accidents.isnull().<span class="bu">sum</span>()</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>accidents <span class="op">=</span> accidents[accidents[<span class="st">'Time'</span>].notna()]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>accidents <span class="op">=</span> accidents[accidents[<span class="st">'Date'</span>].notna()]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#making a new column called Hours to use it later for visualization</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Hours"</span>] <span class="op">=</span> accidents[<span class="st">"Time"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(<span class="bu">str</span>(x).split(<span class="st">":"</span>)[<span class="dv">0</span>]))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Year"</span>] <span class="op">=</span> accidents[<span class="st">"Date"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(<span class="bu">str</span>(x).split(<span class="st">"-"</span>)[<span class="dv">0</span>]))</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Month"</span>] <span class="op">=</span> accidents[<span class="st">"Date"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(<span class="bu">str</span>(x).split(<span class="st">"-"</span>)[<span class="dv">1</span>]))</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Day"</span>] <span class="op">=</span> accidents[<span class="st">"Date"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(<span class="bu">str</span>(x).split(<span class="st">"-"</span>)[<span class="dv">2</span>].split(<span class="st">" "</span>)[<span class="dv">0</span>]))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>accidents.drop([<span class="st">'Location_Easting_OSGR'</span>, <span class="st">'Location_Northing_OSGR'</span>,<span class="st">'LSOA_of_Accident_Location'</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Junction_Control'</span>, <span class="st">'Local_Authority_.District.'</span>, <span class="st">'Local_Authority_.Highway.'</span>, </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">'X1st_Road_Class'</span>, <span class="st">'X1st_Road_Number'</span>, <span class="st">'X2nd_Road_Class'</span>, <span class="st">'X2nd_Road_Number'</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'Pedestrian_Crossing.Human_Control'</span>, <span class="st">'Pedestrian_Crossing.Physical_Facilities'</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>               ], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>accidents.drop([<span class="st">"Time"</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Daylight"</span>, <span class="dv">4</span>: <span class="st">"Darkness: street lights present and lit"</span>, </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>            <span class="dv">5</span>: <span class="st">"Darkness: street lights present but unlit"</span>, </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6</span>: <span class="st">"Darkness: no street lighting"</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>            <span class="dv">7</span>: <span class="st">"Darkness: street lighting unknown"</span>}</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Light_Conditions"</span>] <span class="op">=</span> accidents[<span class="st">"Light_Conditions"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Weather Conditions</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Fine without high winds"</span>, <span class="dv">2</span>:<span class="st">"Raining without high winds"</span>,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>           <span class="dv">3</span>:<span class="st">"Snowing without high winds"</span>, <span class="dv">4</span>:<span class="st">"Fine with high winds"</span>,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>           <span class="dv">5</span>:<span class="st">"Raining with high winds"</span>, <span class="dv">6</span>:<span class="st">"Snowing with high winds"</span>,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>           <span class="dv">7</span>:<span class="st">"Fog or mist — if hazard"</span>, <span class="dv">8</span>:<span class="st">"Other"</span>, <span class="dv">9</span>:<span class="st">"Unknown"</span>}</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Weather_Conditions"</span>] <span class="op">=</span> accidents[<span class="st">"Weather_Conditions"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Road Surface Conditions</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Dry"</span>, <span class="dv">2</span>: <span class="st">"Wet/Damp"</span>, <span class="dv">3</span>:<span class="st">"Snow"</span>, <span class="dv">4</span>:<span class="st">"Frost/Ice"</span>, <span class="dv">5</span>:<span class="st">"Flood"</span>}</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Road_Surface_Conditions"</span>] <span class="op">=</span> accidents[<span class="st">"Road_Surface_Conditions"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Carriageway Hazards</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">0</span>: <span class="st">"None"</span>, <span class="dv">1</span>: <span class="st">"Dislodged vehicle"</span>, <span class="dv">2</span>:<span class="st">"Other obects"</span>, <span class="dv">3</span>:<span class="st">"Previous accident"</span>, </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6</span>:<span class="st">"Pedestrian"</span>, <span class="dv">7</span>:<span class="st">"Animal"</span>}</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Carriageway_Hazards"</span>] <span class="op">=</span> accidents[<span class="st">"Carriageway_Hazards"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Did_Police_Officer_Attend_Scene_of_Accident</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Yes"</span>, <span class="dv">2</span>: <span class="st">"No"</span>}</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Did_Police_Officer_Attend_Scene_of_Accident"</span>] <span class="op">=</span> accidents[<span class="st">"Did_Police_Officer_Attend_Scene_of_Accident"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Special_Conditions_at_Site</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">0</span>: <span class="st">"None"</span>,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>: <span class="st">"Auto traffic signal out"</span>,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>: <span class="st">"Auto traffic signal partially defective"</span>,</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>            <span class="dv">3</span>: <span class="st">"Permanent road signing or marking defective or obscured"</span>,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>            <span class="dv">4</span>: <span class="st">"Roadworks"</span>,</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>            <span class="dv">5</span>: <span class="st">"Road surface defective"</span>,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6</span>: <span class="st">"Oil or diesel"</span>,</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>            <span class="dv">7</span>: <span class="st">"Mud"</span>}</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Special_Conditions_at_Site"</span>] <span class="op">=</span> accidents[<span class="st">"Special_Conditions_at_Site"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Road_Type</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Roundabout"</span>,</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>: <span class="st">"One way street"</span>,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>            <span class="dv">3</span>: <span class="st">"Dual carriageway"</span>,</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6</span>: <span class="st">"Single carriageway"</span>,</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>            <span class="dv">7</span>: <span class="st">"Slip road"</span>,</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>            <span class="dv">9</span>: <span class="st">"Unknown"</span>}</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Road_Type"</span>] <span class="op">=</span> accidents[<span class="st">"Road_Type"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Junction_Detail</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">0</span>: <span class="st">"Not at or within 20 metres of junction"</span>, </span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>: <span class="st">"Roundabout"</span>,</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>: <span class="st">"Mini roundabout"</span>,</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>            <span class="dv">3</span>: <span class="st">"T or staggered junction"</span>,</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>            <span class="dv">4</span>: <span class="st">"Slip road"</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>            <span class="dv">5</span>: <span class="st">"Crossroads"</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6</span>: <span class="st">"Junction more than four arms (not RAB)"</span>,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>            <span class="dv">7</span>: <span class="st">"Using private drive or entrance"</span>,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>            <span class="dv">8</span>: <span class="st">"Other junction"</span>}</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Junction_Detail"</span>] <span class="op">=</span> accidents[<span class="st">"Junction_Detail"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Sunday"</span>, </span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>: <span class="st">"Monday"</span>,</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>            <span class="dv">3</span>: <span class="st">"Tuesday"</span>,</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>            <span class="dv">4</span>: <span class="st">"Wednesday"</span>,</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>            <span class="dv">5</span>: <span class="st">"Thursday"</span>,</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6</span>: <span class="st">"Friday"</span>,</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>            <span class="dv">7</span>: <span class="st">"Saturday"</span>}</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Day_of_Week"</span>] <span class="op">=</span> accidents[<span class="st">"Day_of_Week"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Urban Area"</span>, </span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>: <span class="st">"Rural Area"</span>,</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>            <span class="dv">3</span>: <span class="st">"Unknown"</span>}</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Urban_or_Rural_Area"</span>] <span class="op">=</span> accidents[<span class="st">"Urban_or_Rural_Area"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>accidents.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Accident_Index</th>
      <th>Longitude</th>
      <th>Latitude</th>
      <th>Police_Force</th>
      <th>Accident_Severity</th>
      <th>Number_of_Vehicles</th>
      <th>Number_of_Casualties</th>
      <th>Date</th>
      <th>Day_of_Week</th>
      <th>Road_Type</th>
      <th>...</th>
      <th>Weather_Conditions</th>
      <th>Road_Surface_Conditions</th>
      <th>Special_Conditions_at_Site</th>
      <th>Carriageway_Hazards</th>
      <th>Urban_or_Rural_Area</th>
      <th>Did_Police_Officer_Attend_Scene_of_Accident</th>
      <th>Hours</th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>200501BS00001</td>
      <td>-0.191170</td>
      <td>51.489096</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2005-01-04</td>
      <td>Tuesday</td>
      <td>Single carriageway</td>
      <td>...</td>
      <td>Raining without high winds</td>
      <td>Wet/Damp</td>
      <td>None</td>
      <td>None</td>
      <td>Urban Area</td>
      <td>Yes</td>
      <td>17</td>
      <td>2005</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>200501BS00002</td>
      <td>-0.211708</td>
      <td>51.520075</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2005-01-05</td>
      <td>Wednesday</td>
      <td>Dual carriageway</td>
      <td>...</td>
      <td>Fine without high winds</td>
      <td>Dry</td>
      <td>None</td>
      <td>None</td>
      <td>Urban Area</td>
      <td>Yes</td>
      <td>17</td>
      <td>2005</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>200501BS00003</td>
      <td>-0.206458</td>
      <td>51.525301</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>2005-01-06</td>
      <td>Thursday</td>
      <td>Single carriageway</td>
      <td>...</td>
      <td>Fine without high winds</td>
      <td>Dry</td>
      <td>None</td>
      <td>None</td>
      <td>Urban Area</td>
      <td>Yes</td>
      <td>0</td>
      <td>2005</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>200501BS00004</td>
      <td>-0.173862</td>
      <td>51.482442</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2005-01-07</td>
      <td>Friday</td>
      <td>Single carriageway</td>
      <td>...</td>
      <td>Fine without high winds</td>
      <td>Dry</td>
      <td>None</td>
      <td>None</td>
      <td>Urban Area</td>
      <td>Yes</td>
      <td>10</td>
      <td>2005</td>
      <td>1</td>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>200501BS00005</td>
      <td>-0.156618</td>
      <td>51.495752</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2005-01-10</td>
      <td>Monday</td>
      <td>Single carriageway</td>
      <td>...</td>
      <td>Fine without high winds</td>
      <td>Wet/Damp</td>
      <td>None</td>
      <td>None</td>
      <td>Urban Area</td>
      <td>Yes</td>
      <td>21</td>
      <td>2005</td>
      <td>1</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 23 columns</p>
</div>
</div>
</div>
</section>
<section id="analysis-and-visualizations" class="level2">
<h2 class="anchored" data-anchor-id="analysis-and-visualizations">Analysis and Visualizations</h2>
<p>Data analysis and visualizations are extremely crucial as they help to uncover patterns, trends, and insights that might not be apparent from the raw data alone allowing a researcher to communicate their findings effectively and make informed decisions based on the data.</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.dates <span class="im">as</span> mdates</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define x-axis ticks</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>ticks <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">24</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define x-axis tick labels</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>tick_labels <span class="op">=</span> [mdates.num2date(mdates.datestr2num(<span class="ss">f'</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">:00'</span>)).strftime(<span class="st">'%I %p'</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">24</span>)]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> determine_day(x):</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="kw">in</span> [<span class="st">"Saturday"</span>, <span class="st">"Sunday"</span>]:</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Weekend"</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Weekday"</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Type_of_Day"</span>] <span class="op">=</span> accidents[<span class="st">'Day_of_Week'</span>].<span class="bu">apply</span>(determine_day)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>sns.lineplot(</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>accidents.groupby([<span class="st">'Hours'</span>, <span class="st">"Type_of_Day"</span>]).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>), </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'Hours'</span>, y<span class="op">=</span><span class="st">'count'</span>, hue<span class="op">=</span><span class="st">"Type_of_Day"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'Peak Office Travel Hours'</span>, xy<span class="op">=</span>(<span class="fl">7.5</span>, <span class="dv">123000</span>), xycoords<span class="op">=</span><span class="st">'data'</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>            xytext<span class="op">=</span>(<span class="fl">0.01</span>, <span class="fl">.99</span>), textcoords<span class="op">=</span><span class="st">'axes fraction'</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">'top'</span>, ha<span class="op">=</span><span class="st">'left'</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'black'</span>, shrink<span class="op">=</span><span class="fl">0.05</span>))</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'Peak Office Travel Hours'</span>, xy<span class="op">=</span>(<span class="fl">16.5</span>, <span class="dv">130000</span>), xycoords<span class="op">=</span><span class="st">'data'</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>            xytext<span class="op">=</span>(<span class="fl">0.01</span>, <span class="fl">.99</span>), textcoords<span class="op">=</span><span class="st">'axes fraction'</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">'top'</span>, ha<span class="op">=</span><span class="st">'left'</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'black'</span>, shrink<span class="op">=</span><span class="fl">0.05</span>))</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Hour of the day"</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of accidents"</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Number of accidents in each hour"</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="blog_files/figure-html/cell-3-output-1.png" width="618" height="449"></p>
</div>
</div>
<p>The line plot depicted above illustrates the frequency of accidents per hour of the day. Rush hours, particularly at 8:00 AM and 6:00 PM, witnessed the highest number of accidents due to heavy traffic, while the frequency decreased during non-peak hours when individuals were engaged in their daily activities or at home.</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>accidents, x<span class="op">=</span><span class="st">"Speed_limit"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Speed limit (mph)"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of accidents"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Number of accidents"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>plt.ticklabel_format(style<span class="op">=</span><span class="st">'plain'</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="blog_files/figure-html/cell-4-output-1.png" width="627" height="449"></p>
</div>
</div>
<p>Although there is a widespread perception that accidents primarily occur at high speeds, particularly on highways, the above bar graph analysis suggests that most accidents occur at relatively lower speeds, notably at 30 mph. This finding may be attributed to the greater number of 30 mph roads as compared to other roads in the UK.</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>accidents, x<span class="op">=</span><span class="st">"Day_of_Week"</span>, color<span class="op">=</span><span class="st">'#2358AC'</span>, order<span class="op">=</span>[<span class="st">"Sunday"</span>, <span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>, <span class="st">"Saturday"</span>])</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Day of the Week"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of accidents"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Number of accidents by day"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>accidents, x<span class="op">=</span><span class="st">"Year"</span>, color<span class="op">=</span><span class="st">'#2358AC'</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Year"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of accidents"</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Number of accidents by year"</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="blog_files/figure-html/cell-5-output-1.png" width="662" height="293"></p>
</div>
</div>
<p>As demonstrated in the first graph above, Fridays witnessed the highest number of accidents, whereas the number of accidents decreased significantly on Saturdays and Sundays when people tend to commute less. Generally, weekdays have a higher incidence of accidents compared to weekends.</p>
<p>Moreover, the second bar graph shows a gradual decline in the number of accidents over time, which may have happened because of improved traffic management system and enhanced civic sense. Additionally, the advancement of automation technology in the transportation sector may have contributed to this positive trend.</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>casualties <span class="op">=</span> pd.read_csv(<span class="st">"../data/casualties.csv"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>casualties[<span class="st">"Age_Group"</span>] <span class="op">=</span> pd.cut(casualties[<span class="st">'Age_of_Casualty'</span>], bins<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">100</span>], right<span class="op">=</span><span class="va">False</span>, labels<span class="op">=</span>[<span class="st">"0-10"</span>, <span class="st">"10-20"</span>, <span class="st">"20-30"</span>, <span class="st">"30-40"</span>, <span class="st">"40-50"</span>, <span class="st">"50-60"</span>, <span class="st">"60-70"</span>, <span class="st">"70-80"</span>, <span class="st">"80+"</span> ])</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>casualties[<span class="st">"Casualty_Severity"</span>] <span class="op">=</span> casualties[<span class="st">"Casualty_Severity"</span>].astype(<span class="bu">object</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="op">-</span><span class="dv">1</span>: <span class="st">"Unknown"</span>, <span class="dv">1</span>:<span class="st">"Male"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>           <span class="dv">2</span>:<span class="st">"Female"</span>}</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>casualties[<span class="st">"Sex_of_Casualty"</span>] <span class="op">=</span> casualties[<span class="st">"Sex_of_Casualty"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> casualties[casualties[<span class="st">"Sex_of_Casualty"</span>] <span class="op">!=</span> <span class="st">"Unknown"</span>]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">"Age_Group"</span>, hue<span class="op">=</span><span class="st">"Sex_of_Casualty"</span>, element<span class="op">=</span><span class="st">"poly"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Age Group"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Total number of Accidents"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribution of addidents based on sex"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="blog_files/figure-html/cell-6-output-1.png" width="618" height="449"></p>
</div>
</div>
<p>According to the graph above, a higher number of casualties were observed among men compared to women. However, this does not necessarily imply that men were more frequently involved in accidents as drivers or passengers, but rather that accident reports primarily recorded men as the driver or passenger involved in the accident.</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>casualties, x<span class="op">=</span><span class="st">"Age_Group"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Age Group"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of accidents"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Number of accidents based on age group"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="blog_files/figure-html/cell-7-output-1.png" width="618" height="449"></p>
</div>
</div>
<p>Similarly, the data suggests that individuals aged 20-30 had a higher incidence of accidents compared to other age groups.</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.basemap <span class="im">import</span> Basemap</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>new_accidents <span class="op">=</span> accidents.dropna()</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a map object</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>map_uk <span class="op">=</span> Basemap(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    projection<span class="op">=</span><span class="st">'merc'</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    llcrnrlat<span class="op">=</span><span class="fl">49.5</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    urcrnrlat<span class="op">=</span><span class="fl">60.5</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    llcrnrlon<span class="op">=-</span><span class="fl">11.5</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    urcrnrlon<span class="op">=</span><span class="fl">2.0</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    resolution<span class="op">=</span><span class="st">'i'</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw coastlines, countries, and rivers</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>map_uk.drawcoastlines(linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>map_uk.drawcountries(linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>map_uk.drawrivers(linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot scatter points for each location in the dataframe</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> map_uk(new_accidents[<span class="st">'Longitude'</span>].values, new_accidents[<span class="st">'Latitude'</span>].values)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>map_uk.scatter(x, y, marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'r'</span>, alpha<span class="op">=</span><span class="dv">1</span>, s<span class="op">=</span><span class="fl">0.00001</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the map</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="./map.png" class="img-fluid"></p>
<p>Based on the UK map above, it can be inferred that the majority of accidents occur in major urban centers such as London, Liverpool, Glasgow, Leeds etc where there is a high concentration of small roads and heavy traffic, rather than on highways or rural areas with higher speed limits but fewer roads.</p>
</section>
<section id="machine-learning-models" class="level2">
<h2 class="anchored" data-anchor-id="machine-learning-models">Machine Learning Models</h2>
<p>The severity of accidents levels(1,2 and 3, with 3 being the most extreme) was sought to be predicted based on several parameters, including Longitude, Latitude, Police Force, Number of Vehicles, Number of Casualties, Day of Week, Road Type, and Speed Limit. To achieve this, three machine learning classification models, namely Decision Tree, K Nearest Neighbors, and Random Forest, were trained.</p>
<p>To assess the performance of these models, the F-1 score was measured, which is typically more useful than accuracy when dealing with an uneven class distribution, as evidenced by the confusion matrix below. Accuracy is most effective when the cost of false positives and false negatives is similar.</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pd.options.mode.chained_assignment <span class="op">=</span> <span class="va">None</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>np.set_printoptions(suppress<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">FutureWarning</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>accidents <span class="op">=</span> pd.read_csv(<span class="st">"../data/accidents.csv"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>accidents <span class="op">=</span> accidents.dropna()</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>accidents.drop([<span class="st">'Location_Easting_OSGR'</span>, <span class="st">'Location_Northing_OSGR'</span>,<span class="st">'LSOA_of_Accident_Location'</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Junction_Control'</span>, <span class="st">'Local_Authority_.District.'</span>, <span class="st">'Local_Authority_.Highway.'</span>, </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">'X1st_Road_Class'</span>, <span class="st">'X1st_Road_Number'</span>, <span class="st">'X2nd_Road_Class'</span>, <span class="st">'X2nd_Road_Number'</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'Pedestrian_Crossing.Human_Control'</span>, <span class="st">'Pedestrian_Crossing.Physical_Facilities'</span>, <span class="st">"Date"</span>, <span class="st">"Time"</span>, <span class="st">"Accident_Index"</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>               ], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, f1_score</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> accidents[<span class="st">"Accident_Severity"</span>]</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>accidents.drop(<span class="st">"Accident_Severity"</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> accidents</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y,test_size<span class="op">=</span><span class="fl">0.20</span>, random_state<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co"># print(X_train)</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> [</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Decision Tree"</span>, DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>)),</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"K Neighbors"</span>, KNeighborsClassifier()),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Random Forest"</span>, RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>))</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>result_dict <span class="op">=</span> {}</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, model <span class="kw">in</span> models:</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot confusion matrix</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    cm <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    plt.figure()</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f"Confusion Matrix of </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">"Blues"</span>)</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Predicted label"</span>)</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"True label"</span>)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate and print f1 score</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    f1 <span class="op">=</span> f1_score(y_test, y_pred, average<span class="op">=</span><span class="st">'micro'</span>)</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    result_dict[name] <span class="op">=</span> f1</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> F1 score: </span><span class="sc">{</span>f1<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="./img1.png" class="img-fluid" alt="Decision Tree"> <img src="./img2.png" class="img-fluid" alt="K Neighbors"> <img src="./img3.png" class="img-fluid" alt="Random Forest"></p>
<p>After training the three machine learning classification models, we evaluated their performance using F-1 score as the metric. The Decision Tree model achieved an F-1 score of 0.750769, K Nearest Neighbors had an F-1 score of 0.830499, and Random Forest had the highest F-1 score of 0.835909 among the three models compared. The Random Forest model was found to be the most effective in predicting the severity of accidents based on the given parameters.</p>
<p>For the future, plans involve exploring further machine learning models and tuning their hyperparameters to continue the research and see if any other models can be applied to predict noteworthy outcomes. It is planned to expand the scope of the analysis and incorporate more variables to gain better insights into the factors that contribute to accidents. The performance of the current models will also be further evaluated and compared with other state-of-the-art models to ensure that the best model is chosen for the prediction task. I hope the results of this research will be used to develop effective strategies to improve road safety and reduce the number of accidents in the future.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>UK Accident Data (2005-2016). Kaggle. Retrieved February 5,<br>
&nbsp;&nbsp;&nbsp;&nbsp;2023, from <a href="https://www.kaggle.com/datasets/nichaoku/gbaccident0516?select=acc2005_2016.csv" class="uri">https://www.kaggle.com/datasets/nichaoku/gbaccident0516?select=acc2005_2016.csv</a></p>
<p><a href="http://data.dft.gov.uk/road-accidents-safety-data/Road-Accident-Safety-Data-Guide.xls" class="uri">http://data.dft.gov.uk/road-accidents-safety-data/Road-Accident-Safety-Data-Guide.xls</a></p>
<p><a href="https://data.gov.uk/dataset/road-accidents-safety-data" class="uri">https://data.gov.uk/dataset/road-accidents-safety-data</a></p>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb9" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "UK Road Accidents"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Road Accident Analysis from 2005-2016"</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Ayush Mainali"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> false</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: default</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">    rendering: embed-resources</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf: default</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="al">![ ](./accident.jpeg)</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>Road accidents are a major cause of concern worldwide, and the situation is no different in Great Britain. With the increasing number of vehicles on the roads each year, it's essential to analyze the available data to identify patterns and trends and take proactive measures to reduce road accidents. This blog post will provide a detailed report of personal injury road accident datasets available on Kaggle to gain a better understanding of road safety in Great Britain. </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>The datasets provide information on the circumstances of accidents, the types of vehicles involved, and the resulting casualties, making them a valuable resource for researchers and policymakers alike. However, it's important to note that these statistics only cover personal injury accidents that are reported to the police and recorded using the STATS19 form(a form that offers features to retrieve and arrange data on road accidents, allowing users to access the UK's authorized database of road traffic casualties.), so we must keep this limitation in mind when interpreting the results.</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dataset Description</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>The dataset in use is "The Great Britain Road Accident 2005-2016" dataset from Kaggle. Along with the accident report dataset, the dataset includes two other sub-datasets: Vehicle Description and Casualty Reference. The data as a whole was retrieved from the UK Department of Transportation government <span class="co">[</span><span class="ot">website</span><span class="co">](http://data.dft.gov.uk/road-accidents-safety-data/Road-Accident-Safety-Data-Guide.xls)</span>.  </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>The dataset has 1.7 million rows of data with 32 variable columns. For the 7% of null data in the dataset the rows are simply dropped in accordance to when they are beign analyzed. A couple of variables have integers instead of categorical descriptions, hence, the encoded values for variables such as light condition, road type, weather condition etc are mapped to their actual values for effective visualization.</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>The key variables in use for analysis are as follows:</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>i) Latitude and longitude: The geographic location of the data where the accident occured.</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>ii) Accident Severity: The damage severity of accident (categorized by 1, 2 and 3(3 being the most severe)) </span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>iii) Accident Day: The day of the week.</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>iv) Accident Time: The time of the day.</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>v) Speed zone: The speed limit roads for accident. </span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>vi) Vehicle: Type of vehicle resulting in most number of accidents- cars/SUVs/Trucks, Bus etc</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>vii) Road Type: Type of road that saw most number of the accidents</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>viii) Light Condition: The light outside when the accident occured. Morning sun, midday light, dawn, dusk etc</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>ix) The gender of accident: male, female, or others</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>x) Age: The driver's age</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>xi) Officers at scene: Number of police offices and local administratives that arrived in scene after the accident occured.</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>xii) Road Surface condition: Conditions such as wet, damp, dry etc</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>After reading the data through the file, adjusting the date and time format, reverse encoding the numerical to categorical values for the table, filtering and dropping the null values in accordance to what information is needed where, the final table summarizes to this: </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="co">#Installing and importing packages</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>pd.options.mode.chained_assignment <span class="op">=</span> <span class="va">None</span> </span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">FutureWarning</span>)</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>accidents <span class="op">=</span> pd.read_csv(<span class="st">"../data/accidents.csv"</span>)</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>date_format <span class="op">=</span> <span class="st">"</span><span class="sc">%d</span><span class="st">/%m/%Y"</span> </span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Date"</span>] <span class="op">=</span> pd.to_datetime(accidents[<span class="st">"Date"</span>], <span class="bu">format</span><span class="op">=</span>date_format)</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>accidents.isnull().<span class="bu">sum</span>()</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>accidents <span class="op">=</span> accidents[accidents[<span class="st">'Time'</span>].notna()]</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>accidents <span class="op">=</span> accidents[accidents[<span class="st">'Date'</span>].notna()]</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a><span class="co">#making a new column called Hours to use it later for visualization</span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Hours"</span>] <span class="op">=</span> accidents[<span class="st">"Time"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(<span class="bu">str</span>(x).split(<span class="st">":"</span>)[<span class="dv">0</span>]))</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Year"</span>] <span class="op">=</span> accidents[<span class="st">"Date"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(<span class="bu">str</span>(x).split(<span class="st">"-"</span>)[<span class="dv">0</span>]))</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Month"</span>] <span class="op">=</span> accidents[<span class="st">"Date"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(<span class="bu">str</span>(x).split(<span class="st">"-"</span>)[<span class="dv">1</span>]))</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Day"</span>] <span class="op">=</span> accidents[<span class="st">"Date"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(<span class="bu">str</span>(x).split(<span class="st">"-"</span>)[<span class="dv">2</span>].split(<span class="st">" "</span>)[<span class="dv">0</span>]))</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>accidents.drop([<span class="st">'Location_Easting_OSGR'</span>, <span class="st">'Location_Northing_OSGR'</span>,<span class="st">'LSOA_of_Accident_Location'</span>,</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Junction_Control'</span>, <span class="st">'Local_Authority_.District.'</span>, <span class="st">'Local_Authority_.Highway.'</span>, </span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>                <span class="st">'X1st_Road_Class'</span>, <span class="st">'X1st_Road_Number'</span>, <span class="st">'X2nd_Road_Class'</span>, <span class="st">'X2nd_Road_Number'</span>,</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'Pedestrian_Crossing.Human_Control'</span>, <span class="st">'Pedestrian_Crossing.Physical_Facilities'</span></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>               ], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>accidents.drop([<span class="st">"Time"</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Daylight"</span>, <span class="dv">4</span>: <span class="st">"Darkness: street lights present and lit"</span>, </span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>            <span class="dv">5</span>: <span class="st">"Darkness: street lights present but unlit"</span>, </span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6</span>: <span class="st">"Darkness: no street lighting"</span>,</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>            <span class="dv">7</span>: <span class="st">"Darkness: street lighting unknown"</span>}</span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Light_Conditions"</span>] <span class="op">=</span> accidents[<span class="st">"Light_Conditions"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Weather Conditions</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Fine without high winds"</span>, <span class="dv">2</span>:<span class="st">"Raining without high winds"</span>,</span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>           <span class="dv">3</span>:<span class="st">"Snowing without high winds"</span>, <span class="dv">4</span>:<span class="st">"Fine with high winds"</span>,</span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>           <span class="dv">5</span>:<span class="st">"Raining with high winds"</span>, <span class="dv">6</span>:<span class="st">"Snowing with high winds"</span>,</span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>           <span class="dv">7</span>:<span class="st">"Fog or mist — if hazard"</span>, <span class="dv">8</span>:<span class="st">"Other"</span>, <span class="dv">9</span>:<span class="st">"Unknown"</span>}</span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Weather_Conditions"</span>] <span class="op">=</span> accidents[<span class="st">"Weather_Conditions"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Road Surface Conditions</span></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Dry"</span>, <span class="dv">2</span>: <span class="st">"Wet/Damp"</span>, <span class="dv">3</span>:<span class="st">"Snow"</span>, <span class="dv">4</span>:<span class="st">"Frost/Ice"</span>, <span class="dv">5</span>:<span class="st">"Flood"</span>}</span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Road_Surface_Conditions"</span>] <span class="op">=</span> accidents[<span class="st">"Road_Surface_Conditions"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Carriageway Hazards</span></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">0</span>: <span class="st">"None"</span>, <span class="dv">1</span>: <span class="st">"Dislodged vehicle"</span>, <span class="dv">2</span>:<span class="st">"Other obects"</span>, <span class="dv">3</span>:<span class="st">"Previous accident"</span>, </span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6</span>:<span class="st">"Pedestrian"</span>, <span class="dv">7</span>:<span class="st">"Animal"</span>}</span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Carriageway_Hazards"</span>] <span class="op">=</span> accidents[<span class="st">"Carriageway_Hazards"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Did_Police_Officer_Attend_Scene_of_Accident</span></span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Yes"</span>, <span class="dv">2</span>: <span class="st">"No"</span>}</span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Did_Police_Officer_Attend_Scene_of_Accident"</span>] <span class="op">=</span> accidents[<span class="st">"Did_Police_Officer_Attend_Scene_of_Accident"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Special_Conditions_at_Site</span></span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">0</span>: <span class="st">"None"</span>,</span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>: <span class="st">"Auto traffic signal out"</span>,</span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>: <span class="st">"Auto traffic signal partially defective"</span>,</span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>            <span class="dv">3</span>: <span class="st">"Permanent road signing or marking defective or obscured"</span>,</span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>            <span class="dv">4</span>: <span class="st">"Roadworks"</span>,</span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>            <span class="dv">5</span>: <span class="st">"Road surface defective"</span>,</span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6</span>: <span class="st">"Oil or diesel"</span>,</span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>            <span class="dv">7</span>: <span class="st">"Mud"</span>}</span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Special_Conditions_at_Site"</span>] <span class="op">=</span> accidents[<span class="st">"Special_Conditions_at_Site"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Road_Type</span></span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Roundabout"</span>,</span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>: <span class="st">"One way street"</span>,</span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a>            <span class="dv">3</span>: <span class="st">"Dual carriageway"</span>,</span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6</span>: <span class="st">"Single carriageway"</span>,</span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a>            <span class="dv">7</span>: <span class="st">"Slip road"</span>,</span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a>            <span class="dv">9</span>: <span class="st">"Unknown"</span>}</span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Road_Type"</span>] <span class="op">=</span> accidents[<span class="st">"Road_Type"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a><span class="co">#Reverse encoding the values of the Junction_Detail</span></span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">0</span>: <span class="st">"Not at or within 20 metres of junction"</span>, </span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>: <span class="st">"Roundabout"</span>,</span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>: <span class="st">"Mini roundabout"</span>,</span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a>            <span class="dv">3</span>: <span class="st">"T or staggered junction"</span>,</span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true" tabindex="-1"></a>            <span class="dv">4</span>: <span class="st">"Slip road"</span>,</span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true" tabindex="-1"></a>            <span class="dv">5</span>: <span class="st">"Crossroads"</span>,</span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6</span>: <span class="st">"Junction more than four arms (not RAB)"</span>,</span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true" tabindex="-1"></a>            <span class="dv">7</span>: <span class="st">"Using private drive or entrance"</span>,</span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true" tabindex="-1"></a>            <span class="dv">8</span>: <span class="st">"Other junction"</span>}</span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Junction_Detail"</span>] <span class="op">=</span> accidents[<span class="st">"Junction_Detail"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Sunday"</span>, </span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>: <span class="st">"Monday"</span>,</span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a>            <span class="dv">3</span>: <span class="st">"Tuesday"</span>,</span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a>            <span class="dv">4</span>: <span class="st">"Wednesday"</span>,</span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a>            <span class="dv">5</span>: <span class="st">"Thursday"</span>,</span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6</span>: <span class="st">"Friday"</span>,</span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a>            <span class="dv">7</span>: <span class="st">"Saturday"</span>}</span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Day_of_Week"</span>] <span class="op">=</span> accidents[<span class="st">"Day_of_Week"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Urban Area"</span>, </span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>: <span class="st">"Rural Area"</span>,</span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true" tabindex="-1"></a>            <span class="dv">3</span>: <span class="st">"Unknown"</span>}</span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Urban_or_Rural_Area"</span>] <span class="op">=</span> accidents[<span class="st">"Urban_or_Rural_Area"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true" tabindex="-1"></a>accidents.head()</span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analysis and Visualizations</span></span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-160"><a href="#cb9-160" aria-hidden="true" tabindex="-1"></a>Data analysis and visualizations are extremely crucial as they help to uncover patterns, trends, and insights that might not be apparent from the raw data alone allowing a researcher to communicate their findings effectively and make informed decisions based on the data.</span>
<span id="cb9-161"><a href="#cb9-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-162"><a href="#cb9-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-165"><a href="#cb9-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-166"><a href="#cb9-166" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.dates <span class="im">as</span> mdates</span>
<span id="cb9-167"><a href="#cb9-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-168"><a href="#cb9-168" aria-hidden="true" tabindex="-1"></a><span class="co"># Define x-axis ticks</span></span>
<span id="cb9-169"><a href="#cb9-169" aria-hidden="true" tabindex="-1"></a>ticks <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">24</span>)</span>
<span id="cb9-170"><a href="#cb9-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-171"><a href="#cb9-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Define x-axis tick labels</span></span>
<span id="cb9-172"><a href="#cb9-172" aria-hidden="true" tabindex="-1"></a>tick_labels <span class="op">=</span> [mdates.num2date(mdates.datestr2num(<span class="ss">f'</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">:00'</span>)).strftime(<span class="st">'%I %p'</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">24</span>)]</span>
<span id="cb9-173"><a href="#cb9-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-174"><a href="#cb9-174" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> determine_day(x):</span>
<span id="cb9-175"><a href="#cb9-175" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="kw">in</span> [<span class="st">"Saturday"</span>, <span class="st">"Sunday"</span>]:</span>
<span id="cb9-176"><a href="#cb9-176" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Weekend"</span></span>
<span id="cb9-177"><a href="#cb9-177" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb9-178"><a href="#cb9-178" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Weekday"</span></span>
<span id="cb9-179"><a href="#cb9-179" aria-hidden="true" tabindex="-1"></a>accidents[<span class="st">"Type_of_Day"</span>] <span class="op">=</span> accidents[<span class="st">'Day_of_Week'</span>].<span class="bu">apply</span>(determine_day)</span>
<span id="cb9-180"><a href="#cb9-180" aria-hidden="true" tabindex="-1"></a>sns.lineplot(</span>
<span id="cb9-181"><a href="#cb9-181" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>accidents.groupby([<span class="st">'Hours'</span>, <span class="st">"Type_of_Day"</span>]).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>), </span>
<span id="cb9-182"><a href="#cb9-182" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'Hours'</span>, y<span class="op">=</span><span class="st">'count'</span>, hue<span class="op">=</span><span class="st">"Type_of_Day"</span>)</span>
<span id="cb9-183"><a href="#cb9-183" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'Peak Office Travel Hours'</span>, xy<span class="op">=</span>(<span class="fl">7.5</span>, <span class="dv">123000</span>), xycoords<span class="op">=</span><span class="st">'data'</span>,</span>
<span id="cb9-184"><a href="#cb9-184" aria-hidden="true" tabindex="-1"></a>            xytext<span class="op">=</span>(<span class="fl">0.01</span>, <span class="fl">.99</span>), textcoords<span class="op">=</span><span class="st">'axes fraction'</span>,</span>
<span id="cb9-185"><a href="#cb9-185" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">'top'</span>, ha<span class="op">=</span><span class="st">'left'</span>,</span>
<span id="cb9-186"><a href="#cb9-186" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'black'</span>, shrink<span class="op">=</span><span class="fl">0.05</span>))</span>
<span id="cb9-187"><a href="#cb9-187" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'Peak Office Travel Hours'</span>, xy<span class="op">=</span>(<span class="fl">16.5</span>, <span class="dv">130000</span>), xycoords<span class="op">=</span><span class="st">'data'</span>,</span>
<span id="cb9-188"><a href="#cb9-188" aria-hidden="true" tabindex="-1"></a>            xytext<span class="op">=</span>(<span class="fl">0.01</span>, <span class="fl">.99</span>), textcoords<span class="op">=</span><span class="st">'axes fraction'</span>,</span>
<span id="cb9-189"><a href="#cb9-189" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">'top'</span>, ha<span class="op">=</span><span class="st">'left'</span>,</span>
<span id="cb9-190"><a href="#cb9-190" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'black'</span>, shrink<span class="op">=</span><span class="fl">0.05</span>))</span>
<span id="cb9-191"><a href="#cb9-191" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Hour of the day"</span>)</span>
<span id="cb9-192"><a href="#cb9-192" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of accidents"</span>)</span>
<span id="cb9-193"><a href="#cb9-193" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Number of accidents in each hour"</span>)</span>
<span id="cb9-194"><a href="#cb9-194" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-195"><a href="#cb9-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-196"><a href="#cb9-196" aria-hidden="true" tabindex="-1"></a>The line plot depicted above illustrates the frequency of accidents per hour of the day. Rush hours, particularly at 8:00 AM and 6:00 PM, witnessed the highest number of accidents due to heavy traffic, while the frequency decreased during non-peak hours when individuals were engaged in their daily activities or at home.</span>
<span id="cb9-197"><a href="#cb9-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-200"><a href="#cb9-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-201"><a href="#cb9-201" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>accidents, x<span class="op">=</span><span class="st">"Speed_limit"</span>)</span>
<span id="cb9-202"><a href="#cb9-202" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Speed limit (mph)"</span>)</span>
<span id="cb9-203"><a href="#cb9-203" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of accidents"</span>)</span>
<span id="cb9-204"><a href="#cb9-204" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Number of accidents"</span>)</span>
<span id="cb9-205"><a href="#cb9-205" aria-hidden="true" tabindex="-1"></a>plt.ticklabel_format(style<span class="op">=</span><span class="st">'plain'</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb9-206"><a href="#cb9-206" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-207"><a href="#cb9-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-208"><a href="#cb9-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-209"><a href="#cb9-209" aria-hidden="true" tabindex="-1"></a>Although there is a widespread perception that accidents primarily occur at high speeds, particularly on highways, the above bar graph analysis suggests that most accidents occur at relatively lower speeds, notably at 30 mph. This finding may be attributed to the greater number of 30 mph roads as compared to other roads in the UK.</span>
<span id="cb9-210"><a href="#cb9-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-213"><a href="#cb9-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-214"><a href="#cb9-214" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb9-215"><a href="#cb9-215" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>accidents, x<span class="op">=</span><span class="st">"Day_of_Week"</span>, color<span class="op">=</span><span class="st">'#2358AC'</span>, order<span class="op">=</span>[<span class="st">"Sunday"</span>, <span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>, <span class="st">"Saturday"</span>])</span>
<span id="cb9-216"><a href="#cb9-216" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb9-217"><a href="#cb9-217" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Day of the Week"</span>)</span>
<span id="cb9-218"><a href="#cb9-218" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of accidents"</span>)</span>
<span id="cb9-219"><a href="#cb9-219" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Number of accidents by day"</span>)</span>
<span id="cb9-220"><a href="#cb9-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-221"><a href="#cb9-221" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb9-222"><a href="#cb9-222" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>accidents, x<span class="op">=</span><span class="st">"Year"</span>, color<span class="op">=</span><span class="st">'#2358AC'</span>)</span>
<span id="cb9-223"><a href="#cb9-223" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb9-224"><a href="#cb9-224" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Year"</span>)</span>
<span id="cb9-225"><a href="#cb9-225" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of accidents"</span>)</span>
<span id="cb9-226"><a href="#cb9-226" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Number of accidents by year"</span>)</span>
<span id="cb9-227"><a href="#cb9-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-228"><a href="#cb9-228" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb9-229"><a href="#cb9-229" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-230"><a href="#cb9-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-231"><a href="#cb9-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-232"><a href="#cb9-232" aria-hidden="true" tabindex="-1"></a>As demonstrated in the first graph above, Fridays witnessed the highest number of accidents, whereas the number of accidents decreased significantly on Saturdays and Sundays when people tend to commute less. Generally, weekdays have a higher incidence of accidents compared to weekends.</span>
<span id="cb9-233"><a href="#cb9-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-234"><a href="#cb9-234" aria-hidden="true" tabindex="-1"></a>Moreover, the second bar graph shows a gradual decline in the number of accidents over time, which may have happened because of improved traffic management system and enhanced civic sense. Additionally, the advancement of automation technology in the transportation sector may have contributed to this positive trend.</span>
<span id="cb9-235"><a href="#cb9-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-238"><a href="#cb9-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-239"><a href="#cb9-239" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-240"><a href="#cb9-240" aria-hidden="true" tabindex="-1"></a>casualties <span class="op">=</span> pd.read_csv(<span class="st">"../data/casualties.csv"</span>)</span>
<span id="cb9-241"><a href="#cb9-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-242"><a href="#cb9-242" aria-hidden="true" tabindex="-1"></a>casualties[<span class="st">"Age_Group"</span>] <span class="op">=</span> pd.cut(casualties[<span class="st">'Age_of_Casualty'</span>], bins<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">100</span>], right<span class="op">=</span><span class="va">False</span>, labels<span class="op">=</span>[<span class="st">"0-10"</span>, <span class="st">"10-20"</span>, <span class="st">"20-30"</span>, <span class="st">"30-40"</span>, <span class="st">"40-50"</span>, <span class="st">"50-60"</span>, <span class="st">"60-70"</span>, <span class="st">"70-80"</span>, <span class="st">"80+"</span> ])</span>
<span id="cb9-243"><a href="#cb9-243" aria-hidden="true" tabindex="-1"></a>casualties[<span class="st">"Casualty_Severity"</span>] <span class="op">=</span> casualties[<span class="st">"Casualty_Severity"</span>].astype(<span class="bu">object</span>)</span>
<span id="cb9-244"><a href="#cb9-244" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> {<span class="op">-</span><span class="dv">1</span>: <span class="st">"Unknown"</span>, <span class="dv">1</span>:<span class="st">"Male"</span>,</span>
<span id="cb9-245"><a href="#cb9-245" aria-hidden="true" tabindex="-1"></a>           <span class="dv">2</span>:<span class="st">"Female"</span>}</span>
<span id="cb9-246"><a href="#cb9-246" aria-hidden="true" tabindex="-1"></a>casualties[<span class="st">"Sex_of_Casualty"</span>] <span class="op">=</span> casualties[<span class="st">"Sex_of_Casualty"</span>].<span class="bu">map</span>(new_data)</span>
<span id="cb9-247"><a href="#cb9-247" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> casualties[casualties[<span class="st">"Sex_of_Casualty"</span>] <span class="op">!=</span> <span class="st">"Unknown"</span>]</span>
<span id="cb9-248"><a href="#cb9-248" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">"Age_Group"</span>, hue<span class="op">=</span><span class="st">"Sex_of_Casualty"</span>, element<span class="op">=</span><span class="st">"poly"</span>)</span>
<span id="cb9-249"><a href="#cb9-249" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Age Group"</span>)</span>
<span id="cb9-250"><a href="#cb9-250" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Total number of Accidents"</span>)</span>
<span id="cb9-251"><a href="#cb9-251" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribution of addidents based on sex"</span>)</span>
<span id="cb9-252"><a href="#cb9-252" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-253"><a href="#cb9-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-254"><a href="#cb9-254" aria-hidden="true" tabindex="-1"></a>According to the graph above, a higher number of casualties were observed among men compared to women. However, this does not necessarily imply that men were more frequently involved in accidents as drivers or passengers, but rather that accident reports primarily recorded men as the driver or passenger involved in the accident.</span>
<span id="cb9-255"><a href="#cb9-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-258"><a href="#cb9-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-259"><a href="#cb9-259" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>casualties, x<span class="op">=</span><span class="st">"Age_Group"</span>)</span>
<span id="cb9-260"><a href="#cb9-260" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Age Group"</span>)</span>
<span id="cb9-261"><a href="#cb9-261" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of accidents"</span>)</span>
<span id="cb9-262"><a href="#cb9-262" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Number of accidents based on age group"</span>)</span>
<span id="cb9-263"><a href="#cb9-263" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-264"><a href="#cb9-264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-265"><a href="#cb9-265" aria-hidden="true" tabindex="-1"></a>Similarly, the data suggests that individuals aged 20-30 had a higher incidence of accidents compared to other age groups.</span>
<span id="cb9-266"><a href="#cb9-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-269"><a href="#cb9-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-270"><a href="#cb9-270" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb9-271"><a href="#cb9-271" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-272"><a href="#cb9-272" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.basemap <span class="im">import</span> Basemap</span>
<span id="cb9-273"><a href="#cb9-273" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-274"><a href="#cb9-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-275"><a href="#cb9-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-276"><a href="#cb9-276" aria-hidden="true" tabindex="-1"></a>new_accidents <span class="op">=</span> accidents.dropna()</span>
<span id="cb9-277"><a href="#cb9-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-278"><a href="#cb9-278" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a map object</span></span>
<span id="cb9-279"><a href="#cb9-279" aria-hidden="true" tabindex="-1"></a>map_uk <span class="op">=</span> Basemap(</span>
<span id="cb9-280"><a href="#cb9-280" aria-hidden="true" tabindex="-1"></a>    projection<span class="op">=</span><span class="st">'merc'</span>,</span>
<span id="cb9-281"><a href="#cb9-281" aria-hidden="true" tabindex="-1"></a>    llcrnrlat<span class="op">=</span><span class="fl">49.5</span>,</span>
<span id="cb9-282"><a href="#cb9-282" aria-hidden="true" tabindex="-1"></a>    urcrnrlat<span class="op">=</span><span class="fl">60.5</span>,</span>
<span id="cb9-283"><a href="#cb9-283" aria-hidden="true" tabindex="-1"></a>    llcrnrlon<span class="op">=-</span><span class="fl">11.5</span>,</span>
<span id="cb9-284"><a href="#cb9-284" aria-hidden="true" tabindex="-1"></a>    urcrnrlon<span class="op">=</span><span class="fl">2.0</span>,</span>
<span id="cb9-285"><a href="#cb9-285" aria-hidden="true" tabindex="-1"></a>    resolution<span class="op">=</span><span class="st">'i'</span></span>
<span id="cb9-286"><a href="#cb9-286" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-287"><a href="#cb9-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-288"><a href="#cb9-288" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw coastlines, countries, and rivers</span></span>
<span id="cb9-289"><a href="#cb9-289" aria-hidden="true" tabindex="-1"></a>map_uk.drawcoastlines(linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb9-290"><a href="#cb9-290" aria-hidden="true" tabindex="-1"></a>map_uk.drawcountries(linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb9-291"><a href="#cb9-291" aria-hidden="true" tabindex="-1"></a>map_uk.drawrivers(linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb9-292"><a href="#cb9-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-293"><a href="#cb9-293" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot scatter points for each location in the dataframe</span></span>
<span id="cb9-294"><a href="#cb9-294" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> map_uk(new_accidents[<span class="st">'Longitude'</span>].values, new_accidents[<span class="st">'Latitude'</span>].values)</span>
<span id="cb9-295"><a href="#cb9-295" aria-hidden="true" tabindex="-1"></a>map_uk.scatter(x, y, marker<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'r'</span>, alpha<span class="op">=</span><span class="dv">1</span>, s<span class="op">=</span><span class="fl">0.00001</span>)</span>
<span id="cb9-296"><a href="#cb9-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-297"><a href="#cb9-297" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the map</span></span>
<span id="cb9-298"><a href="#cb9-298" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-299"><a href="#cb9-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-300"><a href="#cb9-300" aria-hidden="true" tabindex="-1"></a><span class="al">![](./map.png)</span></span>
<span id="cb9-301"><a href="#cb9-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-302"><a href="#cb9-302" aria-hidden="true" tabindex="-1"></a>Based on the UK map above, it can be inferred that the majority of accidents occur in major urban centers such as London, Liverpool, Glasgow, Leeds etc where there is a high concentration of small roads and heavy traffic, rather than on highways or rural areas with higher speed limits but fewer roads. </span>
<span id="cb9-303"><a href="#cb9-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-304"><a href="#cb9-304" aria-hidden="true" tabindex="-1"></a><span class="fu">## Machine Learning Models</span></span>
<span id="cb9-305"><a href="#cb9-305" aria-hidden="true" tabindex="-1"></a>The severity of accidents levels(1,2 and 3, with 3 being the most extreme) was sought to be predicted based on several parameters, including Longitude, Latitude, Police Force, Number of Vehicles, Number of Casualties, Day of Week, Road Type, and Speed Limit. To achieve this, three machine learning classification models, namely Decision Tree, K Nearest Neighbors, and Random Forest, were trained.</span>
<span id="cb9-306"><a href="#cb9-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-307"><a href="#cb9-307" aria-hidden="true" tabindex="-1"></a>To assess the performance of these models, the F-1 score was measured, which is typically more useful than accuracy when dealing with an uneven class distribution, as evidenced by the confusion matrix below. Accuracy is most effective when the cost of false positives and false negatives is similar.</span>
<span id="cb9-308"><a href="#cb9-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-311"><a href="#cb9-311" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-312"><a href="#cb9-312" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb9-313"><a href="#cb9-313" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-314"><a href="#cb9-314" aria-hidden="true" tabindex="-1"></a>pd.options.mode.chained_assignment <span class="op">=</span> <span class="va">None</span> </span>
<span id="cb9-315"><a href="#cb9-315" aria-hidden="true" tabindex="-1"></a>np.set_printoptions(suppress<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-316"><a href="#cb9-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-317"><a href="#cb9-317" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">FutureWarning</span>)</span>
<span id="cb9-318"><a href="#cb9-318" aria-hidden="true" tabindex="-1"></a>accidents <span class="op">=</span> pd.read_csv(<span class="st">"../data/accidents.csv"</span>)</span>
<span id="cb9-319"><a href="#cb9-319" aria-hidden="true" tabindex="-1"></a>accidents <span class="op">=</span> accidents.dropna()</span>
<span id="cb9-320"><a href="#cb9-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-321"><a href="#cb9-321" aria-hidden="true" tabindex="-1"></a>accidents.drop([<span class="st">'Location_Easting_OSGR'</span>, <span class="st">'Location_Northing_OSGR'</span>,<span class="st">'LSOA_of_Accident_Location'</span>,</span>
<span id="cb9-322"><a href="#cb9-322" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Junction_Control'</span>, <span class="st">'Local_Authority_.District.'</span>, <span class="st">'Local_Authority_.Highway.'</span>, </span>
<span id="cb9-323"><a href="#cb9-323" aria-hidden="true" tabindex="-1"></a>                <span class="st">'X1st_Road_Class'</span>, <span class="st">'X1st_Road_Number'</span>, <span class="st">'X2nd_Road_Class'</span>, <span class="st">'X2nd_Road_Number'</span>,</span>
<span id="cb9-324"><a href="#cb9-324" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'Pedestrian_Crossing.Human_Control'</span>, <span class="st">'Pedestrian_Crossing.Physical_Facilities'</span>, <span class="st">"Date"</span>, <span class="st">"Time"</span>, <span class="st">"Accident_Index"</span></span>
<span id="cb9-325"><a href="#cb9-325" aria-hidden="true" tabindex="-1"></a>               ], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-326"><a href="#cb9-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-327"><a href="#cb9-327" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb9-328"><a href="#cb9-328" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, f1_score</span>
<span id="cb9-329"><a href="#cb9-329" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb9-330"><a href="#cb9-330" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb9-331"><a href="#cb9-331" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb9-332"><a href="#cb9-332" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-333"><a href="#cb9-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-334"><a href="#cb9-334" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb9-335"><a href="#cb9-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-336"><a href="#cb9-336" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> accidents[<span class="st">"Accident_Severity"</span>]</span>
<span id="cb9-337"><a href="#cb9-337" aria-hidden="true" tabindex="-1"></a>accidents.drop(<span class="st">"Accident_Severity"</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-338"><a href="#cb9-338" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> accidents</span>
<span id="cb9-339"><a href="#cb9-339" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y,test_size<span class="op">=</span><span class="fl">0.20</span>, random_state<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb9-340"><a href="#cb9-340" aria-hidden="true" tabindex="-1"></a><span class="co"># print(X_train)</span></span>
<span id="cb9-341"><a href="#cb9-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-342"><a href="#cb9-342" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> [</span>
<span id="cb9-343"><a href="#cb9-343" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Decision Tree"</span>, DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>)),</span>
<span id="cb9-344"><a href="#cb9-344" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"K Neighbors"</span>, KNeighborsClassifier()),</span>
<span id="cb9-345"><a href="#cb9-345" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Random Forest"</span>, RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>))</span>
<span id="cb9-346"><a href="#cb9-346" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb9-347"><a href="#cb9-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-348"><a href="#cb9-348" aria-hidden="true" tabindex="-1"></a>result_dict <span class="op">=</span> {}</span>
<span id="cb9-349"><a href="#cb9-349" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, model <span class="kw">in</span> models:</span>
<span id="cb9-350"><a href="#cb9-350" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb9-351"><a href="#cb9-351" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb9-352"><a href="#cb9-352" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot confusion matrix</span></span>
<span id="cb9-353"><a href="#cb9-353" aria-hidden="true" tabindex="-1"></a>    cm <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb9-354"><a href="#cb9-354" aria-hidden="true" tabindex="-1"></a>    plt.figure()</span>
<span id="cb9-355"><a href="#cb9-355" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f"Confusion Matrix of </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-356"><a href="#cb9-356" aria-hidden="true" tabindex="-1"></a>    sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">"Blues"</span>)</span>
<span id="cb9-357"><a href="#cb9-357" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Predicted label"</span>)</span>
<span id="cb9-358"><a href="#cb9-358" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"True label"</span>)</span>
<span id="cb9-359"><a href="#cb9-359" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb9-360"><a href="#cb9-360" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate and print f1 score</span></span>
<span id="cb9-361"><a href="#cb9-361" aria-hidden="true" tabindex="-1"></a>    f1 <span class="op">=</span> f1_score(y_test, y_pred, average<span class="op">=</span><span class="st">'micro'</span>)</span>
<span id="cb9-362"><a href="#cb9-362" aria-hidden="true" tabindex="-1"></a>    result_dict[name] <span class="op">=</span> f1</span>
<span id="cb9-363"><a href="#cb9-363" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> F1 score: </span><span class="sc">{</span>f1<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb9-364"><a href="#cb9-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-365"><a href="#cb9-365" aria-hidden="true" tabindex="-1"></a><span class="al">![Decision Tree](./img1.png)</span></span>
<span id="cb9-366"><a href="#cb9-366" aria-hidden="true" tabindex="-1"></a><span class="al">![K Neighbors](./img2.png)</span></span>
<span id="cb9-367"><a href="#cb9-367" aria-hidden="true" tabindex="-1"></a><span class="al">![Random Forest](./img3.png)</span></span>
<span id="cb9-368"><a href="#cb9-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-369"><a href="#cb9-369" aria-hidden="true" tabindex="-1"></a>After training the three machine learning classification models, we evaluated their performance using F-1 score as the metric. The Decision Tree model achieved an F-1 score of 0.750769, K Nearest Neighbors had an F-1 score of 0.830499, and Random Forest had the highest F-1 score of 0.835909 among the three models compared. The Random Forest model was found to be the most effective in predicting the severity of accidents based on the given parameters.</span>
<span id="cb9-370"><a href="#cb9-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-371"><a href="#cb9-371" aria-hidden="true" tabindex="-1"></a>For the future, plans involve exploring further machine learning models and tuning their hyperparameters to continue the research and see if any other models can be applied to predict noteworthy outcomes. It is planned to expand the scope of the analysis and incorporate more variables to gain better insights into the factors that contribute to accidents. The performance of the current models will also be further evaluated and compared with other state-of-the-art models to ensure that the best model is chosen for the prediction task. I hope the results of this research will be used to develop effective strategies to improve road safety and reduce the number of accidents in the future.</span>
<span id="cb9-372"><a href="#cb9-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-373"><a href="#cb9-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-374"><a href="#cb9-374" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
<span id="cb9-375"><a href="#cb9-375" aria-hidden="true" tabindex="-1"></a>| UK Accident Data (2005-2016). Kaggle. Retrieved February 5, </span>
<span id="cb9-376"><a href="#cb9-376" aria-hidden="true" tabindex="-1"></a>|     2023, from <span class="ot">&lt;https://www.kaggle.com/datasets/nichaoku/gbaccident0516?select=acc2005_2016.csv&gt;</span></span>
<span id="cb9-377"><a href="#cb9-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-378"><a href="#cb9-378" aria-hidden="true" tabindex="-1"></a>| <span class="ot">&lt;http://data.dft.gov.uk/road-accidents-safety-data/Road-Accident-Safety-Data-Guide.xls&gt;</span></span>
<span id="cb9-379"><a href="#cb9-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-380"><a href="#cb9-380" aria-hidden="true" tabindex="-1"></a>| <span class="ot">&lt;https://data.gov.uk/dataset/road-accidents-safety-data&gt;</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>